<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI写作教练·高中语文</title>
    <link rel="icon" href="logo.png" type="image/png">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: "Microsoft YaHei", sans-serif;
        }
        
        body {
            background: #f5f7fa;
            color: #333;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .container {
            text-align: center;
            padding: 40px;
            max-width: 600px;
        }
        
        .logo {
            width: 80px;
            height: 80px;
            margin: 0 auto 20px;
            display: block;
        }
        
        h1 {
            font-size: 2rem;
            color: #2c5530;
            margin-bottom: 30px;
            cursor: pointer;
            transition: color 0.3s;
        }
        
        h1:hover {
            color: #5a7d5a;
        }
        
        .loading {
            margin-top: 20px;
            font-size: 0.9rem;
            color: #666;
            line-height: 1.6;
        }
        
        .countdown {
            font-weight: bold;
            color: #2c5530;
        }
        
        .status {
            margin-top: 15px;
            padding: 10px;
            border-radius: 4px;
            font-size: 0.9rem;
        }
        
        .status.connecting {
            background-color: #e8f4fd;
            color: #0066cc;
        }
        
        .status.success {
            background-color: #f0f9eb;
            color: #67c23a;
        }
        
        .status.fallback {
            background-color: #fdf6ec;
            color: #e6a23c;
        }
        
        .status.error {
            background-color: #fef0f0;
            color: #f56c6c;
        }
        
        .manual-jump {
            margin-top: 20px;
            padding: 10px 20px;
            background-color: #2c5530;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: background-color 0.3s;
        }
        
        .manual-jump:hover {
            background-color: #5a7d5a;
        }
        
        .link-info {
            margin-top: 15px;
            font-size: 0.8rem;
            color: #999;
        }
    </style>
</head>
<body>
    <div class="container">
        <img src="logo.png" alt="AI写作教练" class="logo">
        <h1 id="jumpLink">AI写作教练·高中语文</h1>
        <div class="loading">
            正在跳转到AI写作教练页面（说明：服务器按需定时开放；如果页面不能正常访问，意味着我们的服务器没有开放）... 
            <span id="countdown" class="countdown">5</span>秒
        </div>
        <div id="status" class="status connecting">正在检测默认链接可用性...</div>
        <button id="manualJump" class="manual-jump">手动跳转</button>
        <div class="link-info">
            当前使用链接: <span id="currentLink">检测中...</span>
        </div>
    </div>

    <script>
        // 目标跳转链接
        const primaryUrl = 'https://8c666b6eabbd.ngrok-free.app';
        const fallbackUrl = 'https://customproject.kmelearning.com/ai-view/index.html#/writing-assistant/';
        
        // 获取元素
        const jumpLink = document.getElementById('jumpLink');
        const countdownElement = document.getElementById('countdown');
        const statusElement = document.getElementById('status');
        const manualJumpButton = document.getElementById('manualJump');
        const currentLinkElement = document.getElementById('currentLink');
        
        let currentUrl = primaryUrl; // 当前使用的URL
        let countdown = 5;
        let countdownInterval;
        
        // 检测链接可用性
        function checkUrlAvailability(url) {
            return new Promise((resolve) => {
                const img = new Image();
                img.onload = () => resolve(true);
                img.onerror = () => resolve(false);
                img.src = url + '/favicon.ico?t=' + new Date().getTime();
                
                // 设置超时
                setTimeout(() => resolve(false), 3000);
            });
        }
        
        // 更新状态显示
        function updateStatus(message, type) {
            statusElement.textContent = message;
            statusElement.className = 'status ' + type;
        }
        
        // 执行跳转
        function performJump() {
            window.location.href = currentUrl;
        }
        
        // 开始检测并跳转
        async function startJumpProcess() {
            updateStatus('正在检测默认链接可用性...', 'connecting');
            currentLinkElement.textContent = primaryUrl;
            
            // 检测默认链接
            const isPrimaryAvailable = await checkUrlAvailability(primaryUrl);
            
            if (isPrimaryAvailable) {
                updateStatus('默认链接可用，准备跳转...', 'success');
                currentUrl = primaryUrl;
            } else {
                updateStatus('默认链接不可用，已切换到备用链接', 'fallback');
                currentUrl = fallbackUrl;
                currentLinkElement.textContent = fallbackUrl;
            }
            
            // 开始倒计时
            countdownInterval = setInterval(function() {
                countdown--;
                countdownElement.textContent = countdown;
                
                if (countdown <= 0) {
                    clearInterval(countdownInterval);
                    performJump();
                }
            }, 1000);
        }
        
        // 点击跳转
        jumpLink.addEventListener('click', performJump);
        
        // 手动跳转按钮
        manualJumpButton.addEventListener('click', function() {
            clearInterval(countdownInterval);
            performJump();
        });
        
        // 页面加载后开始检测
        window.addEventListener('load', startJumpProcess);
    </script>
</body>
</html>
